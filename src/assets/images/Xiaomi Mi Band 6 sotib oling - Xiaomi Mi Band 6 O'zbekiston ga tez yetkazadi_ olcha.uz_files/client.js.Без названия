(()=>{"use strict";var e=e=>{const t=document.createElement("iframe");return t.id=e,t.setAttribute("title",e),t.setAttribute("name",e),t.setAttribute("src","about:blank"),t.setAttribute("scrolling","no"),t.setAttribute("frameBorder","0"),t.setAttribute("allowfullscreen",""),t},t="__replain_widget",i="__replain_widget_iframe",n="__replain_widget_iframe_embedded",d={INIT:"onReplainEmbeddedInit"},r={init(t){t.addEventListener(d.INIT,(({detail:t})=>{const i=document.body.querySelector(`#${t.wrapperId}`);null!==i&&(window.ReplainWidget.embedded={...t,width:i.getAttribute("data-width")||t.width,height:i.getAttribute("data-height")||t.height,subject:i.getAttribute("data-subject")||null,theme:i.getAttribute("data-theme")||"light"},(t=>{t.style.display="none";const i=e(n);t.appendChild(i),i.contentDocument.write('<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Re:plain Embedded</title><link href="https://widget.replain.cc/dist/css/embedded.4448eded.css" rel="stylesheet"></head><body><div id="app"></div><script src="https://widget.replain.cc/dist/js/embedded.89463c88.js"><\/script></body></html>'),i.contentDocument.close()})(i))}))}};let a=!1;var o=()=>{if(!0===a)return void console.warn("[RE:PLAIN] Prevent duplicate initialization");a=!0,window.ReplainWidget={};const n=e(i),d=document.createElement("div");d.id=t,d.style.display="none",d.appendChild(n),document.body.appendChild(d),n.contentDocument.write('<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Re:plain</title><link href="https://widget.replain.cc/dist/css/app.32a98d58.css" rel="stylesheet"></head><body><div id="app"></div><script src="https://widget.replain.cc/dist/js/app.84643693.js"><\/script></body></html>'),n.contentDocument.close(),r.init(n)};function l(e,t){return t.some((t=>{const i="/"===t[0]?t:`/${t}`;if("*"===t.substr(-1)){const i=t.substr(0,t.length-1);return 0===e.indexOf(i)}return e===i}))}const s=window.location.search,c=`${window.location.pathname}${s}`;function p(e){if(!e||!e.id)return{error:"Invalid widget code"};if(!1===e.showChat)return{error:"Skip page by `showChat`"};const{excludePages:t=[]}=e;if(t.length>0&&l(c,t))return{error:"Skip page by `excludePages`"};const{includePages:i=[]}=e;return i.length>0&&!l(c,i)?{error:"Skip page by `includePages`"}:{}}let u=null;window.WebSocket||(u="WebSocket is not supported"),window.replainSettings||(window.replainSettings={id:window.__REPLAIN_}),(()=>{if(void 0!==window.replainInitialized)return void console.warn("[RE:PLAIN] Duplicate widget code");if(window.replainInitialized=!0,u)return void console.warn(`[RE:PLAIN] ${u}`);const{replainSettings:e}=window,t=(e=>{let t=e;Array.isArray(t)||(t=[t]);let i=null;for(const e of t){const t=p(e);t.error?console.warn(`[RE:PLAIN] ${t.error} (id: ${e.id})`):i=e}return"?replain-chat-open"===s&&void 0===i.openChatAfterPageLoad&&(i.openChatAfterPageLoad=!0),i})(e);null!==t?(window.replainSettings=t,"complete"!==document.readyState?window.addEventListener("load",o,!1):o()):console.warn("[RE:PLAIN] Settings not found")})()})();